
% need to look at docx file for this equation. 




Equation 25

Based on the rule of derivation, 

$\frac{\partial \varphi _{i}^{C}}{\partial u_{i}}=\frac{\partial 
\varphi _{i}^{C}}{\partial h^{C}}\frac{\partial h^{C}}{\partial u_{i}}$
\\


$\frac{\partial \theta _{i}^{C}}{\partial u_{i}}=\frac{\partial \theta 
_{i}^{C}}{\partial h^{C}}\frac{\partial h^{C}}{\partial u_{i}}$\\


$\frac{\partial \varphi _{i}^{C}}{\partial v_{i}}=\frac{\partial 
\varphi _{i}^{C}}{\partial h^{C}}\frac{\partial h^{C}}{\partial v_{i}}$
\\


$\frac{\partial \theta _{i}^{C}}{\partial v_{i}}=\frac{\partial \theta 
_{i}^{C}}{\partial h^{C}}\frac{\partial h^{C}}{\partial v_{i}}$\\


Equation 26

and

$\frac{\partial \varphi _{i}^{C}}{\partial h^{C}}=\lbrack 
\begin{bmatrix}
\frac{\partial \varphi _{i}^{C}}{\partial h_{x}^{C}} & \frac{\partial 
\varphi _{i}^{C}}{\partial h_{y}^{C}} & \frac{\partial \varphi 
_{i}^{C}}{\partial h_{z}^{C}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
\frac{-h_{x}^{C}\cdot 
h_{z}^{C}}{(h_{x}^{C}^{2}+h_{y}^{C}^{2}+h_{z}^{C}^{2})\sqrt{h_{x}^{C}^{2}+h_{y}^{C}^{2}}} 
& \\
\frac{-h_{y}^{W}\cdot 
h_{z}^{W}}{(h_{x}^{C}^{2}+h_{y}^{C}^{2}+h_{z}^{C}^{2})\sqrt{h_{x}^{C}^{2}+h_{y}^{C}^{2}}} 
& \\

\frac{\sqrt{h_{x}^{C}^{2}+h_{y}^{C}^{2}}}{(h_{x}^{C}^{2}+h_{y}^{C}^{2}+h_{z}^{C}^{2})} 
& \\
\end{bmatrix}
\rbrack ^{T}$\\


Equation 27

$\frac{\partial \theta _{i}^{C}}{\partial h^{C}}=\lbrack \begin{bmatrix}
\frac{\partial \theta _{i}^{C}}{\partial h_{x}^{C}} & \frac{\partial 
\theta _{i}^{C}}{\partial h_{y}^{C}} & \frac{\partial \theta 
_{i}^{C}}{\partial h_{z}^{C}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
-\frac{h_{y}^{C}}{h_{x}^{C}^{2}+h_{y}^{C}^{2}} & 
\frac{h_{x}^{C}}{h_{x}^{C}^{2}+h_{y}^{C}^{2}} & 0 & \\
\end{bmatrix}
\rbrack $\\


Equation 28

\ \ \ \ 

$\frac{\partial h^{C}}{\partial u_{i}}=\lbrack \begin{bmatrix}
\frac{\partial h_{x}^{C}}{\partial u_{i}} & \\
\frac{\partial h_{y}^{C}}{\partial u_{i}} & \\
\frac{\partial h_{z}^{C}}{\partial u_{i}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
0 & \\
s_{x} & \\
0 & \\
\end{bmatrix}
\rbrack $\\


Equation 29



$\frac{\partial h^{C}}{\partial v_{i}}=\lbrack \begin{bmatrix}
\frac{\partial h_{x}^{C}}{\partial v_{i}} & \\
\frac{\partial h_{y}^{C}}{\partial v_{i}} & \\
\frac{\partial h_{z}^{C}}{\partial v_{i}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
0 & \\
0 & \\
s_{y} & \\
\end{bmatrix}
\rbrack $\\


Equation 30



\subsubsection{Linearization of Measurement Model}
The measurement model of the algorithm is not linear, and must be 
linearized by evaluating first derivative of the measurement equation at 
the predicted camera location. Since the measurement model is not a 
function of world origin coordinate and orientation, the Jacobian matrix 
of the measurement model is\ \ \ \ 

$\frac{\partial h_{k}^{U}(x)}{\partial x}=\lbrack \begin{bmatrix}
\begin{bmatrix}
0_{2n\times 6} & \frac{\partial h_{k}^{U}(x)}{\partial c^{C}} & 
\frac{\partial h_{k}^{U}(x)}{\partial r^{C}} & \\
\end{bmatrix}
 & \begin{bmatrix}
\frac{\partial h_{k}^{U}(x)}{\partial p_{1}} & \ldots & \frac{\partial 
h_{k}^{U}(x)}{\partial p_{n}} & \\
\end{bmatrix}
 & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
\begin{bmatrix}
0_{2n\times 6} & \frac{\partial h_{k}^{U}}{\partial h_{k}^{C}}\cdot 
\frac{\partial h_{k}^{C}}{\partial c^{C}} & \frac{\partial 
h_{k}^{U}}{\partial h_{k}^{C}}\cdot \frac{\partial h_{k}^{C}}{\partial 
r^{C}} & \\
\end{bmatrix}
 & \begin{bmatrix}
\frac{\partial h_{k}^{U}}{\partial h_{k}^{C}}\cdot \frac{\partial 
h_{k}^{C}}{\partial p_{1}} & \ldots & \frac{\partial h_{k}^{U}}{\partial 
h_{k}^{C}}\cdot \frac{\partial h_{k}^{C}}{\partial p_{n}} & \\
\end{bmatrix}
 & \\
\end{bmatrix}
\rbrack $\\


Equation 31

Elements in the matrix above are given in - . The formula for 
calculating $Q^{-1}$in - can be found in 

\begin{center}$\frac{\partial h_{k}^{U}}{\partial h_{ k}^{C}}= \lbrack 
\begin{bmatrix}
-\frac{s_{x}h_{y,k}^{C}}{h_{x,k}^{C}^{2}} & \frac{s_{x}}{h_{x,k}^{C}} & 
0 & \\
-\frac{s_{y}h_{z,k}^{C}}{h_{x,k}^{C}^{2}} & 0 & 
\frac{s_{y}}{h_{x,k}^{C}} & \\
\end{bmatrix}
\rbrack $\\
\end{center}

Equation 32



$\frac{\partial h^{C}}{\partial c^{C}}=-R^{-1}(r_{k}^{C})\rho _{k}$\\


Equation 33

$\frac{\partial h(x)}{\partial r^{C}}=\lbrack \frac{\partial 
h^{C}}{\partial r_{x}^{C}}\frac{\partial h^{C}}{\partial 
r_{y}^{C}}\frac{\partial h^{C}}{\partial r_{z}^{C}}\rbrack $\\


Equation 34

$\frac{\partial h^{C}}{\partial r_{x}}=\lbrack \begin{bmatrix}
0 & \\

h_{x}^{C}(sin(r_{x})sin(r_{z})+cos(r_{x})cos(r_{z})sin(r_{y}))+h_{y}^{C}(-cos(r_{z})sin(r_{x})+cos(r_{x})sin(r_{y})sin(r_{z})) 
+ h_{z}^{C}cos(r_{x})cos(r_{y}) & \\
h_{x}^{C}(cos(r_{x})\sin 
(r_{z})-cos(r_{z})sin(r_{x})sin(r_{y}))+h_{y}^{C}(-cos(r_{x})cos(r_{z})-sin(r_{x})sin(r_{y})sin(r_{z})) 
- h_{z}^{C}cos(r_{y})sin(r_{x}) & \\
\end{bmatrix}
\rbrack $\\


Equation 35

$\frac{\partial h^{C}}{\partial r_{y}}=\lbrack \begin{bmatrix}
-h_{z}^{C}\cos (r_{y})- h_{x}^{C}\cos (r_{z})sin(r_{y})- 
h_{y}^{C}sin(r_{y})sin(r_{z}) & \\

-h_{z}^{C}sin(r_{x})sin(r_{y})+h_{x}^{C}cos(r_{y})cos(r_{z})sin(r_{x})+h_{y}^{C}cos(r_{y})sin(r_{x})sin(r_{z}) 
& \\

-h_{z}^{C}cos(r_{x})sin(r_{y})+h_{x}^{C}cos(r_{x})cos(r_{y})cos(r_{z})+h_{y}^{C}cos(r_{x})cos(r_{y})sin(r_{z}) 
& \\
\end{bmatrix}
\rbrack $\\


Equation 36

$\frac{\partial h^{C}}{\partial r_{z}}=\lbrack \begin{bmatrix}
h_{y}^{C}cos(r_{y})cos(r_{z})-h_{x}^{C}cos(r_{y})sin(r_{z}) & \\
h_{x}^{C}(-cos(r_{x})\cos (r_{z})- sin(r_{x})\sin (r_{y})\sin (r_{z}))+ 
h_{y}^{C}(-cos(r_{x})sin(r_{z})+cos(r_{z})sin(r_{x})sin(r_{y})) & \\

h_{x}^{C}(cos(r_{z})sin(r_{x})-cos(r_{x})sin(r_{y})sin(r_{z}))+h_{y}^{C}(sin(r_{x})sin(r_{z})+cos(r_{x})cos(r_{z})sin(r_{y})) 
& \\
\end{bmatrix}
\rbrack $\\


Equation 37



\begin{center}$\frac{\partial h^{C}}{\partial p_{i}}=\lbrack 
\begin{bmatrix}
\frac{\partial h^{C}}{\partial x_{i}^{C}} & \frac{\partial 
h^{C}}{\partial y_{i}^{C}} & \frac{\partial h^{C}}{\partial z_{i}^{C}} & 
\\
\end{bmatrix}
\frac{\partial h^{C}}{\partial \rho _{i}}\frac{\partial h^{C}}{\partial 
\theta _{i}}\frac{\partial h^{C}}{\partial \varphi _{i}}\rbrack $\\
\end{center}

Equation 38 is a 3x6 matrix

$\lbrack \begin{bmatrix}
\frac{\partial h^{C}}{\partial x_{i}^{C}} & \frac{\partial 
h^{C}}{\partial y_{i}^{C}} & \frac{\partial h^{C}}{\partial z_{i}^{C}} & 
\\
\end{bmatrix}
\rbrack =Q^{-1}(r_{k}^{C})\rho _{k}$\\


Equation 39

$\frac{\partial h^{C}}{\partial \rho _{i}}=-Q^{-1}(r_{k}^{C})\cdot 
c_{k}$\\


Equation 40

$\frac{\partial h^{C}}{\partial \theta _{i}}=Q^{-1}(r_{k}^{C})\lbrack 
\begin{bmatrix}
-cos(\varphi _{i})\sin (\theta _{i}) & \\
\cos (\varphi _{i})cos?(\theta _{i}) & \\
0 & \\
\end{bmatrix}
\rbrack $\\


Equation 41

$\frac{\partial h^{C}}{\partial \varphi _{i}}= Q^{-1}(r_{k}^{C})\lbrack 
\begin{bmatrix}
-cos(\varphi _{i})sin?(\theta _{i}) & \\
-sin(\varphi _{i})sin?(\theta _{i}) & \\
cos?(\varphi _{i}) & \\
\end{bmatrix}
\rbrack $\\


Equation 42

\subsubsection{Jacobian Matrix of Composition Equations}
$J_{C_{k-1}\to C_{k}}=\frac{\partial x_{k}}{\partial x_{k-1}}=\lbrack 
\frac{\partial x_{k}}{\partial OX_{W, k-1}^{C}}\begin{bmatrix}
\frac{\partial x_{k}}{\partial c_{k-1}} & \frac{\partial x_{k}}{\partial 
r_{k-1}} & \\
\end{bmatrix}
\frac{\partial x_{k}}{\partial p_{1, k-1}^{C}}\frac{\partial 
x_{k}}{\partial p_{2, k-1}^{C}} \cdots \rbrack $\\


Equation 43

$\frac{\partial x_{k}}{\partial OX_{W, k-1}^{C}}$is given by:

$\frac{\partial x_{k}}{\partial OX_{W, k-1}^{C}}=\lbrack \begin{bmatrix}
\frac{\partial O_{W,k}^{C}}{\partial O_{W,k-1}^{C}} & \frac{\partial 
O_{W,k}^{C}}{\partial W_{W,k-1}^{C}} & \\
\begin{bmatrix}
\frac{\partial W_{W,k}^{C}}{\partial O_{W,k-1}^{C}} & \\
\frac{\partial c_{k}}{\partial O_{W,k-1}^{C}} & \\
\frac{\partial r_{k}}{\partial O_{W,k-1}^{C}} & \\
\end{bmatrix}
 & \begin{bmatrix}
\frac{\partial W_{W,k}^{C}}{\partial W_{W,k-1}^{C}} & \\
\frac{\partial c_{k}}{\partial W_{W,k-1}^{C}} & \\
\frac{\partial r_{k}}{\partial W_{W,k-1}^{C}} & \\
\end{bmatrix}
 & \\
\frac{\partial p_{i}^{C}}{\partial O_{W,k-1}^{C}} & \frac{\partial 
p_{i}^{C}}{\partial W_{W,k-1}^{C}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
Q^{-1}(r^{C}) & 0 & \\
0 & I_{3\times 3} & \\
0 & 0 & \\
0 & 0 & \\
0 & 0 & \\
\end{bmatrix}
\rbrack $\\


Equation 44

Derivatives of $x_{k}$with respect to $c$ and $p$are given in - 
. 

$\lbrack \begin{bmatrix}
\frac{\partial O_{W,k}^{C}}{\partial c_{k-1}} & \frac{\partial 
O_{W,k}^{C}}{\partial r_{k-1}} & \\
\begin{bmatrix}
\frac{\partial W_{W,k}^{C}}{\partial c_{k-1}} & \\
\frac{\partial c_{k}}{\partial c_{k-1}} & \\
\frac{\partial r_{k}}{\partial c_{k-1}} & \\
\end{bmatrix}
 & \begin{bmatrix}
\frac{\partial W_{W,k}^{C}}{\partial r_{k-1}} & \\
\frac{\partial c_{k}}{\partial r_{k-1}} & \\
\frac{\partial r_{k}}{\partial r_{k-1}} & \\
\end{bmatrix}
 & \\
\frac{\partial p(0:2)_{i}^{C}}{\partial c_{k-1}} & \frac{\partial 
p(0:2)_{i}^{C}}{\partial r_{k-1}} & \\
\frac{\partial p(3:5)_{i}^{C}}{\partial c_{k-1}} & \frac{\partial 
p(3:5)_{i}^{C}}{\partial r_{k-1}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
-Q^{-1}(r_{k}^{C_{k-1}}) & \frac{\partial 
Q^{-1}(r_{k}^{C_{k-1}})}{\partial r_{k-1}} & \\
0_{3\times 3} & -I_{3\times 3} & \\
I_{3\times 3} & 0_{3\times 3} & \\
0_{3\times 3} & I_{3\times 3} & \\
-Q^{-1}(r_{k}^{C_{k-1}}) & \frac{\partial 
Q^{-1}(r_{k}^{C_{k-1}})}{\partial r_{k-1}} & \\
0_{3\times 3} & pr & \\
\end{bmatrix}
\rbrack $\\


Equation 45

where

$pr=\lbrack \begin{bmatrix}
\begin{bmatrix}
1 & 0 & 0 & \\
\end{bmatrix}
 & \\
\frac{\partial \varphi _{i, k}^{C}}{\partial r_{k-1}} & \\
\frac{\partial \theta _{i, k}^{C}}{\partial r_{k-1}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
\begin{bmatrix}
1 & 0 & 0 & \\
\end{bmatrix}
 & \\
\frac{\partial m^{-1}(Q^{-1}(r_{k}^{C_{k-1}})m(\varphi _{i, 
k}^{C_{k-1}}, \theta _{i, k}^{C_{k-1}}))}{\partial r_{k-1}} & \\
\end{bmatrix}
\rbrack $\\


Equation 46

Let $M=Q^{-1}(r_{k}^{C_{k-1}})m(\varphi _{i, k}^{C_{k-1}}, \theta _{i, 
k}^{C_{k-1}})$, and $m^{-1}=m^{-1}(M)$, then

$\frac{\partial m^{-1}}{\partial r_{k}^{C_{k-1}}}=\frac{\partial 
m^{-1}}{\partial M}\cdot \frac{\partial M}{\partial r_{k}^{C_{k-1}}}$
\\


Equation 47

where

$\frac{\partial M}{\partial r_{k}^{C_{k-1}}}= \frac{\partial 
Q^{-1}(r_{k}^{C_{k-1}})}{\partial r_{k-1}}\cdot m(\varphi _{i, 
k}^{C_{k-1}}, \theta _{i, k}^{C_{k-1}})$\\


Equation 48

as$m^{-1}$isthe function that calculate$[\varphi \theta ]$ from a 
vector,$\frac{\partial m^{-1}}{\partial M}$ is the same as and .

Derivatives of $x_{k}$with respect to feature parameters$p_{i}^{C}
$are given in - 

$\frac{\partial x_{k}^{C_{k}}}{\partial p_{i,k}^{C_{k-1 }}}=\lbrack 
\begin{bmatrix}
\begin{bmatrix}
\frac{\partial O_{W,k}^{C_{k}}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial W_{W,k}^{C_{k}}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial c_{k}^{C_{k}}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\end{bmatrix}
 & \\
\begin{bmatrix}
\frac{\partial r_{k}^{C_{k}}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial p_{i, k}^{C}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\end{bmatrix}
 & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
0 & \\
0 & \\
0 & \\
0 & \\
\frac{\partial p_{i,k}^{C_{k }}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\end{bmatrix}
\rbrack $\\


Equation 49

$\frac{\partial p_{i,k}^{C_{k }}}{\partial p_{i,k}^{C_{k-1 }}}=\lbrack 
\begin{bmatrix}
\frac{\partial x_{i,k}^{C_{k}}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial y_{i,k}^{C}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial z_{i,k}^{C}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial \rho _{i,k}^{C}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial \varphi _{i, k}^{C}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\frac{\partial \theta _{i, k}^{C}}{\partial p_{i,k}^{C_{k-1 }}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
Q^{-1}(r_{k}^{C_{k-1}}) & 0_{3\times 3} & \\
0_{3\times 3} & \frac{\partial p(3:5)_{i,k}^{C_{k}}}{\partial 
p(3:5)_{i,k}^{C_{k-1}}} & \\
\end{bmatrix}
\rbrack $\\


Equation 50



$\frac{\partial p(3:5)_{i,k}^{C_{k}}}{\partial 
p(3:5)_{i,k}^{C_{k-1}}}=\lbrack \begin{bmatrix}
1 & 0 & 0 & \\
0 & \frac{\partial \varphi _{i, k}^{C_{k}}}{\partial \varphi _{i, 
k}^{C_{k-1}}} & \frac{\partial \varphi _{i, k}^{C_{k}}}{\partial \theta 
_{i, k}^{C_{k-1}}} & \\
0 & \frac{\partial \theta _{i, k}^{C_{k}}}{\partial \varphi _{i, 
k}^{C_{k-1}}} & \frac{\partial \theta _{i, k}^{C_{k}}}{\partial \theta 
_{i, k}^{C_{k-1}}} & \\
\end{bmatrix}
\rbrack =\lbrack \begin{bmatrix}
1 & 0 & 0 & \\
0 & \frac{\partial \varphi _{i, k}^{C_{k}}}{\partial M}\frac{\partial 
M}{\partial \varphi _{i, k}^{C_{k-1}}} & \frac{\partial \varphi _{i, 
k}^{C_{k}}}{\partial M}\frac{\partial M}{\partial \theta _{i, 
k}^{C_{k-1}}} & \\
0 & \frac{\partial \theta _{i, k}^{C_{k}}}{\partial M}\frac{\partial 
M}{\partial \varphi _{i, k}^{C_{k-1}}} & \frac{\partial \theta _{i, 
k}^{C_{k}}}{\partial M}\frac{\partial M}{\partial \theta _{i, 
k}^{C_{k-1}}} & \\
\end{bmatrix}
\rbrack $\\


Equation 51

$\frac{\partial \varphi _{i, k}^{C_{k}}}{\partial M}$is the same as . 
$\frac{\partial \theta _{i, k}^{C_{k}}}{\partial M}$is the same as . 
$\frac{\partial M}{\partial \varphi _{i,k}^{C_{k-1}}}$and$
\frac{\partial M}{\partial \theta _{i, k}^{C_{k-1}}}$ is given below.

$\frac{\partial M}{\partial \varphi 
_{i,k}^{C_{k-1}}}=R^{-1}(r^{C})\lbrack \begin{bmatrix}
-\cos (\theta _{i, k}^{C_{k-1}})\sin (\varphi _{i,k}^{C_{k-1}}) & \\
-\sin (\varphi _{i,k}^{C_{k-1}})\sin (\theta _{i, k}^{C_{k-1}}) & \\
\cos (\varphi _{i,k}^{C_{k-1}}) & \\
\end{bmatrix}
\rbrack $\\


Equation 52

$\frac{\partial M}{\partial \theta _{i, 
k}^{C_{k-1}}}=R^{-1}(r^{C})\lbrack \begin{bmatrix}
-\cos (\varphi _{i,k}^{C_{k-1}})\sin (\theta _{i, k}^{C_{k-1}}) & \\
\cos (\varphi _{i,k}^{C_{k-1}})\cos (\theta _{i, k}^{C_{k-1}}) & \\
0 & \\
\end{bmatrix}
\rbrack $\\


Equation 53

\subsubsection{Adding and Deleting 
Features}\label{section:_Toc332876136}
Features that move out of the camera's FOI are removed from the filter. 
The removal is done by directly deleting the parameters from the state 
vector, and the related rows and columns from the state covariance 
matrix. The parameters of the deleted features are still recorded into 
the database, and remained unchanged for all iteration after the removal 
unless a GPS bundle correction occurs. 

To maintain sufficient amount of features to generate map, new features 
are acquired and added to the filter if a feature deletion procedure 
occurred, or number of tracked feature is lower than a threshold. The 
feature addition procedure occurs after the composition step of an 
iteration, and follows the same procedure as described in section . 

\subsubsection{Bundle Correction with GPS (not yet 
implemented)}\label{section:_Toc332876138}
Apply overall correction on the map at a sparser time interval using the 
GPS positions. 

\subsubsection{Processing for Comparison to Ground Truth Data}
The accuracy of the result was analyzed by comparing to the digital 
elevation models (DEM) .To make the comparison, the features coordinate 
and the DEM data must be brought to the same coordinate system. For ease 
of viewing, the world coordinate is used. The features' positions can be 
converted to Euclidean representation in world frame by: 

$\lbrack \begin{bmatrix}
X_{i}^{W} & \\
Y_{i}^{W} & \\
Z_{i}^{W} & \\
\end{bmatrix}
\rbrack =Q^{-1}(O_{XYZ}^{c}, W_{XYZ}^{c})(\lbrack \begin{bmatrix}
x_{i}^{C} & \\
y_{i}^{C} & \\
z_{i}^{C} & \\
\end{bmatrix}
\rbrack +\frac{1}{\rho _{i}}m(\varphi _{i}^{C}, \theta _{i}^{C}))$\\


The DEM is converted into the world frame using the UAV's initial GPS 
location$[\begin{bmatrix}
Latitude_{init} & Longitude_{init} & Height_{init} & \\
\end{bmatrix}
]$ and orientation$\lbrack \begin{bmatrix}
Roll_{init} & Pitch_{init } & Azimuth_{init} & \\
\end{bmatrix}
\rbrack $. First, the UAV's GPS latitude and longitude is converted 
into UTM representation$\begin{bmatrix}
[Northing_{init} & Easting_{init} & Height_{init}] & \\
\end{bmatrix}
$. Then, a transformation matrix can be defined as followed:

$Q_{Roll}^{-1}=\lbrack \begin{bmatrix}
1 & 0 & 0 & 0 & \\
0 & \cos (Roll_{init}) & \sin (Roll_{init}) & 0 & \\
0 & -sin(Roll_{init}) & \cos (Roll_{init}) & 0 & \\
0 & 0 & 0 & 1 & \\
\end{bmatrix}
\rbrack $\\


$Q_{Pitch}^{-1}=\lbrack \begin{bmatrix}
\cos (Pitch_{init}+\pi ) & 0 & -\sin (Pitcch_{init}+\pi ) & 0 & \\
0 & 1 & 0 & 0 & \\
\sin (Pitch_{init}+\pi ) & 0 & \cos (Pitch_{init}+\pi ) & 0 & \\
0 & 0 & 0 & 1 & \\
\end{bmatrix}
\rbrack $\\


$Q_{Azimuth}^{-1}=\lbrack \begin{bmatrix}
\cos (Azimuth_{init}+\frac{\pi }{2}) & \sin (Azimuth_{init}+\frac{\pi 
}{2}) & 0 & 0 & \\
-sin(Azimuth_{init}+\frac{\pi }{2}) & \cos (Azimuth_{init}+\frac{\pi 
}{2}) & 0 & 0 & \\
0 & 0 & 1 & 0 & \\
0 & 0 & 0 & 1 & \\
\end{bmatrix}
\rbrack $\\


$Q_{T}^{-1}=\lbrack \begin{bmatrix}
1 & 0 & 0 & -Northing_{init} & \\
0 & 1 & 0 & -Easting_{init} & \\
0 & 0 & 1 & -Height_{init} & \\
0 & 0 & 0 & 1 & \\
\end{bmatrix}
\rbrack $\\


$Q^{-1}=Q_{T}^{-1}\cdot Q_{Roll}^{-1}\cdot Q_{Pitch}^{-1}\cdot 
Q_{Azimuth}^{-1}$\\


At last, the DEM in world coordinate is given by

$DEM_{World}=Q^{-1}\cdot DEM_{UTM}$\\


